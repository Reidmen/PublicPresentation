<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Modelling of Cortical Bone and Simulations</title>

		<meta name="author" content="Reidmen Arostica B.">

		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<!-- Add css file: letters -->
		<link href="css/letters.css">
		<!--dif]-->
		<!--
		<style>
			div.container {
				display:inline-block;
			}
			[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![en p {
				text-align:left;
			}
		</style>
		-->
		<style>
			div.container {
				display: inline-block;
			}
		</style>

	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<!-- SECTION: PRESENTATION -->
				<section>
					<!--
					<h2>Mathematical Modelling on Cortical Bone</h2>
					<h5>Reidmen Arostica B.</h5>
					<p style="font-size: 15px; text-align: center">
						FCFM, U. de Chile - November, 2018.
					</p>
					-->
					<div class="moving-letters">
    				<h2 class="ml3">Numerical Studies of a Homogenized Bone Model</h1>
						<h5 class="ml3"> Reidmen Arostica B.</h3>
						<p style="font-size: 15px; text-align: center">
							FCFM, U. of Chile - December 2018.
						</p>
					</div>
				</section>

				<!-- SECTION: OF BONE ITSELF -->
				<section style="font-size: 25px; text-align: left">
					<section>
						<h2>Microstructure</h2>
						<p>Cortical Bone is a complex, highly organized hard, and lightweight tissue defined by an hierarchy of microstructures.</p>
						<p>From a mechanical point-of-view, it's defined as a two-phase composite material: a soft phase mainly containing pores of organic fluid and soft tissues embedded in hidroxyapatite and collagen compound.</p>
					</section>
					<section>
						<h2>Mesoscale</h2>
						<p class="fragment">
							The main components preponderant to the mechanical behaviour are defined in the size between $50-200 [\mu m]$.
						</p>
						<ul>
							<li class="fragment">Haversian Canals $\sim 50 [\mu m]$</li>
							<li class="fragment">Resorption Cavities $\sim 50-200 [\mu m]$</li>
						</ul>
					</section>
					<section style="text-align: center">
						<h4> Observed mesoscale microstructure </h4>
						<div class="container">
							<img src="animations/rec_sca03.gif" alt="vertical" width="430" height="370">
						</div>
						<div class="container">
							<img src="animations/rec_sca05_3d.gif" alt="horizontal" width="430" height="370">
						</div>
						<p style="font-size: 20px" Models generated from real $\mu$-CT images.></p>
					</section>
					<section>
						<h3>Relevance</h3>
						<p>The study such tissue, gives us insight of various clinical parameters such as accumulated stress damage, collagen quality, bone turnover and other necessary to diagnose the status and quality of bone.</p>
						<p>Therefore, an early diagnose of osteoporosis, a condition where less bone is added than taken away leading to skeletal fragility and increasing risk of fractures.</p>
					</section>
				</section>

				<!-- SECTION: DEVICE DESCRIPTION -->
				<section style="font-size: 25px; text-align: left">
					<section>
						<h3>Clinical Devices</h3>
						<p>Dual X-ray Absorptiometry (DXA) provides the Bone Mineral Density (BMD) values used to diagnose osteoporosis, based in non-volumetric measures of bone quality.</p>
						<p>For fidelity, X-ray Quantitative Computed Tomography (QCT) is used to assess volumetric density, but is rather expensive with radiation costs involved.</p>
						<p>QuantitativeUltrasound techniques (QUS)provides one possible answer to such deficiencies.</p>
					</section>
					<section>
						<h3> Ultrasound Techniques</h3>
						<p><em>Minonzio et al., 2018</em> developed a QUS procedure to assess bone quality, by retrieving two relevant parameters of bone quality: cortical porosity and thickness.</p>
						<p> The methods describes a lower-cost procedure, with non-invasive nor radiative nature.</p>
						<p> It is expected to reach gold-standard predictions, but wider validation must be obtained and robustness reseach must be taken in consideration.</p>

					</section>
					<section>
						<h3>Schematic description</h3>
						<ol>
							<li>The approach is based on axial transmission measurements which consist of guided waves recodings that propagate throuh the bone.</li>
							<li>It corresponds to studying the response to a ultrasonic surface excitation produced at the surface in form of dispersion curves.</li>
							<li>Wave-guide characteristis such as thickness and porosity are deduced from the dispersion curves by finding the best fitting to theoretical references.</li>
						</ol>
					</section>
					<section style="text-align: center;">
						<div class="container">
							<img src="pictures/SchematicPropagation.png" alt="Schematic Propagation" width="881" height="509">
							<p style="font-size: 20px" class="fragment"> Schematic description of the experimental procedure and idealization of the macroscopic domain with their characteristic microstructure.</p>
						</div>
					</section>
					<section>
						<h3>Signal Processing</h3>
						<ol>
							<li>Each cycle of measurements consist of a sequential excitation of $N^{E} > 0$ emitters, which yield $N^{E}\times N^{R}$ time series array.</li>
							<li>The multi-channel series, $\{ S(t_m, e_m, x_p) \}_{(n,p) \in [N^T]\times [N^R]}$ at fixed emitter $x_p, p \in \{1,\dots, N^E\}$ is Fourier transformed.</li>
							<li>Such transformed array $\hat{S}(\cdot, e_m, \cdot)$ for each emitter is decomposed by Singular Values Method (SVD), in the form 
							\begin{equation}
								P(e_m)\hat{D}P(e_m)^T = \hat{S}(e_m) \quad m \in \{1,\dots, N^E\}
							\end{equation}
							</li>
							<li>The <em>Lamb</em>-waves are then obtained from a function over the first $N^E_*$ resonant modes:
							\begin{equation}
								L(P) := \sum_{m=1}^{N^E_*} P(e_m)\overline{P(e_m)}
							\end{equation}
							</li>
						</ol>
					</section>
					<section style="text-align: center">
						<div class="container">
							<img src="pictures/LW-RealCase.png" alt="Lamb Waves" width="1017" height="434">
							<p class="fragment">Comparison between real signal recording (left) and fitting of <em>Lamb</em>-curves on the signal (right).</p>
						</div>
					</section>
				</section>

				<!-- SECTION: OBJECTIVES PROPOSED -->
				<section style="font-size: 25px; text-align: left" >
					<section>
						<h3>Theoretical-based Objectives</h3>
						<ol>
							<li class="fragment">Study the existence of the elastodynamic multiscale problem used to model the mechanical behavior of bone and the homogenization heuristic.</li>
							<li class="fragment">Describe the homogenized model and study the cell problems that define the elasticity tensor.</li>
							<li class="fragment">Extend the description to a <em>Kelvin-Voigt</em> viscoelastic formulation to add realistic damping effects on the signal.</li>
						</ol>
					</section>
					<section style="font-size: 25px">
						<h3>Numerical-based Objectives</h3>
						<ol>
							<li class="fragment"> Simulate the experimental procedure in a 2D domain retrieving the Lamb curves, thus validating statistically under such controled scenario the inverse problem of <em>Foiret et al. 2014, Minonzio et al. 2018</em></li>
							<li class="fragment"> Simulate on 3-dimensional domains assessing the curvature effects and intrinsic irregularities from the bone architecture.</li>
							<li class="fragment"> Compute homogenized models using the FEM method comparing with the standard <em>Parnell and Grimal. 2008</em> reference.</li>
							<li class="fragment"> Similarly, study the effects viscosity on the homogenized model by defining on the two-scale framework the so-called quality factors comparing with the reference <em>Bernand et al. 2015</em>.</li>
						</ol>
					</section>
				</section>

				<!-- SECTION: OF HOMOGENIZATION IN TIME DOMAIN -->
				<section style="font-size: 25px; text-align: left">
					<section>
						<h3>Hypothesis and Scale Separation</h3>
						<ol>
							<li class="fragment">For each point $\mathbf{x} \in \Omega$ of the domain, let us consider a fast variable $y = \epsilon^{-1} x \in \mathbf{Y}$ where $\mathbf{Y}:= (0,1)^n$ and $n \in {2,3}$ denotes the microstructure domain.</li>
							<li class="fragment">The elements of the elastic tensor, are oscillatory in the form $C_{ijkl}\big(\frac{\mathbf{x}}{\epsilon}\big) \in L^2 (\mathbf{Y})$, so $\mathbf{Y}$-periodic.</li>
						</ol>
					</section>
					<section>
						<div class="container">
							<img src="pictures/HomBasicScheme.png" alt="horizontal" width="876" height="616">
							<p class="fragment"> Idealization of the periodic domain microstructure following a square microstructure.</p>
						</div>
					</section>
					<section>
						<h3>Formally, our PDE problem with highly oscillated terms is modelled by:</h3>
						<p> Find $u(\mathbf{x},t) \in \Omega_T$ being $\Omega$ domain, with $\partial \Omega = \Gamma_D \cup \Gamma_N$ regular enough, solution to:</p>
						\[
						(P) \left \{
						\begin{aligned}
							\rho\big(\frac{\mathbf{x}}{\epsilon}\big) \partial_{tt} u - \nabla \cdot \sigma(u) &amp;= \mathbf{0} &amp; \text{ in } \Omega_T \\
							\sigma(u)_{ij} &amp; = \mathbf{C}\big(\frac{\mathbf{x}}{\epsilon}\big)_{ijkl} \mathbf{e}_{kl}(u) &amp; \text{ in } \Omega_T \\
							u &amp; = \mathbf{0} &amp; \text{ in } \Gamma_D \times [0, T]\\
							\sigma(u) \cdot n &amp; = \mathbf{F}(\mathbf{x},t) &amp; \text{ in } \Gamma_N \times [0,T]
						\end{aligned}
						\right .
						\]
					</section>
					<section>
						<div class="container">
							<img src="pictures/HomBasicOrders.png" alt="horizontal" width="700" height="500">
							<p style="font-size: 20px" class="fragment">The two-important scales associated to the model.</p>
						</div>
					</section>
					<section>
						<h3>It is assumed a two-scale separation in variables $(\mathbf{x}, \frac{\mathbf{x}}{\epsilon})$ being $\epsilon$ the ratio between them.</h3>
						<ul>
							<li class="fragment">
								We seek a asymptotic displacement (solution) describing the behaviour at different orders of $\epsilon$ for each time $t > 0$, by
								\[
								\begin{aligned}
								u(\mathbf{x}, \epsilon, t) &amp; = \sum_{a=0}^{\infty} \epsilon^{a} u^{(a)}\big(\frac{\mathbf{x}}{\epsilon},t\big) \\
								&amp;= u^{(0)}\big(x, \frac{\mathbf{x}}{\epsilon},t\big) + \epsilon^{1} u^{(1)}\big(\frac{\mathbf{x}}{\epsilon},t\big) + \epsilon^{2} u^{(2)}\big(\frac{\mathbf{x}}{\epsilon},t\big) + r(\mathbf{x}, \epsilon, t)
								\end{aligned}
								\]
								being $\mathbf{e}_{kl}(u) = \frac{1}{2}(\partial_{x_k} u_l + \partial_{x_l}u_k)$ the strain tensor.
							</li>
							<li class="fragment">
								Naturally, we would like $\epsilon \rightarrow 0$, the convergence to an <em>effective</em> (macroscopic) model and estimations of the error.
							</li>
						</ul>
					</section>
					<section>
							<p>
								Applying the expansion on the governing model $(P)$ we obtain after separating on $\epsilon$ orders the follows expression:
							</p>
							<p class="fragment">
								\[
									\epsilon^{-2} P_{-2} + \epsilon^{-1} P_{-1} + \epsilon^{0} P_{0} + R = \mathbf{0}
								\]
								being each term of orders $\epsilon^{-2}, \epsilon^{-1}, \epsilon^{0}$ imposed to be $\mathbf{0}$ to satisfy the above equality and $R$ the terms of remaining order $\epsilon^{a}, a > 0$ being the error.
							</p>
							<p class="fragment">
								Explicitily, defining $L_{\alpha \beta}(\,) = \partial_{\alpha_i}\big( C_{ijkl}\mathbf{e}_{kl,\beta}(\, ))$ we seek:
							<ul>
								<li class="fragment"> $P_{-2} = L_{yy}u^{(0)} \overset{\text{impose}}{\longrightarrow} = \textbf{0}$ </li>
								<li class="fragment"> $P_{-1} = L_{xy}u^{(1)} + L_{yx}u^{(0)} + L_{yy}u^{(1)} \overset{\text{impose}}{\longrightarrow}  = \textbf{0}$ </li>
								<li class="fragment"> $P_{0} = L_{xx}u^{(0)} + L_{xy}u^{(1)} + L_{yy} u^{(1)} + \rho(\mathbf{y}) u^{(0)} \overset{\text{impose}}{\longrightarrow}  = \textbf{0}$ </li>
							</ul>
					</section>
					<section>
						<p> Imposing the zero conditions, it follows: </p>
						<ul>
							<li class="fragment">At order $\mathcal{O}(\epsilon^{-2})$ the macroscopic displacement in obtained </li>
							<li class="fragment">
								At order $\mathcal{O}(\epsilon^{-1})$ the cell problems obtained, which define the homogenized coefficients.
								<ul>
									<li class="fragment"> They are expressed as $N^{rs}(\mathbf{y})$ $\mathbf{Y}$-periodic solutions to the equation:
										\[
										\begin{equation*}
										\partial_{y_j}\big[ C_{ijkl}(\mathbf{y}) \mathbf{e}_{kl,y}\big( N^{rs} (\mathbf{y})\big) \big] = - \partial_{y_j} \big[ C_{ijkl}(\mathbf{y}) \big]
										\end{equation*}
										\]
									</li>
									<li class="fragment">
										Supplemented with condition $\langle N^{rs} \rangle_{\mathbf{Y}} = \mathbf{0}$
									</li>
								</ul>
					</section>
					<section>
						<p class="fragment">
							Finally, at order $\mathcal{O}(1)$, its obtained the The homogenized (effective) model, which after reagruping the terms becomes:
						</p>
						<p class="fragment">
							\[
							\begin{aligned}
							\langle \rho\rangle_{\mathbf{Y}} \partial_{tt} v_i  - \partial_{x_j} \big[ C^{hom}_{ijrs} \mathbf{e}_{rs,x}(v)\big] = \mathbf{0}  &amp; \text{ in } (0,T)\times \Omega \\
							\sigma^{hom}(v) \cdot n = \mathbf{F} &amp;\text{ in } (0,T)\times \Gamma_N \\
							v = \mathbf{0} &amp; \text{ in } (0,T)\times \Gamma_D \\
							\partial_t v(0) = v(0) = \mathbf{0} &amp; \text{ in } \Omega
							\end{aligned}
							\]
							being $C_{ijrs}(p) := \langle C_{ijrs}(\mathbf{y}) + C_{ijkl}(\mathbf{y}) \mathbf{e}_{kl,y}\big(\mathbf{N}^{rs}(\mathbf{y})\big) \rangle_{\mathbf{Y}}$.
						</p>
					</section>
					<section>
						<div class="container">
							<img src="pictures/HomBasicEqs.png" alt="horizontal" width="1222" height="618">
							<p style="font-size: 20px" class="fragment">The full model with equations involved.</p>
						</div>
					</section>
					<section>
						<h3>Convergence Result</h3>
						<p>
							Theorem. Assuming that $F \in L^{\infty}(0,T; \mathbf{L}^2(\Gamma_N))$ and also $N^q \in L^{\infty}(0,T;\mathbf{H}^1(\Omega))$ for each $q \in \{1,\dots,N\}$. Then the solutions $u^{\epsilon}$ and $u^{0}$ of multiscale and homogenized problems respectively, satisfy the following inequality:
							\begin{equation}
								\Vert u^{\epsilon} - u^{0} - \epsilon \mathbf{N}^s (\frac{\mathbf{x}}{\epsilon})\partial_{x_s}u^0 \Vert_{L^{\infty}(0,T;\mathbf{H}^1(\Omega, \Gamma_D))} \lesssim \epsilon^{1/2}\Vert u^{0} \Vert_{L^{\infty}(0,T;\mathbf{H}^3(\Omega))}
							\end{equation}
						</p>
					</section>
					<section>
						<h3>Energy Estimation</h3>
						<p>
							Assuming the hypothesis of he above theorem, it follows the convergence results of the energy operators, i.e., 
							\begin{equation}
								\vert E_{\epsilon} (u^{\epsilon}) - E_0 (u^{0}) \vert \lesssim \epsilon^{1/2} \Vert \mathbf{F} \Vert_{L^{\infty}(0, T; \mathbf{L}^2(\Gamma_N))}
							\end{equation}
						</p>
					</section>
				</section>

				<!-- SECTION: NUMERICAL SOLUTIONS TO CELL PROBLEMS -->
				<section style="font-size: 25px; text-align: left">
					<section>
						<h3>Numerical Solutions to Cell Problems</h3>
						<p>The non-linear component is directly related to the solution of the cell problems.</p>
						<p>They are described by the unique vector-valued solutions $\mathbf{N}^{rs} \in \mathbf{H}^1_{\#}(\mathbf{Y})$ for each $r,s \in \{1,\dots, d\}$ of the elliptic PDE system:
						\begin{equation}
						\begin{aligned}
							- \partial_{y_j}\big[C_{ijkl}(\mathbf{y}) \mathbf{e}_{kl,y}\big(\mathbf{N}^{rs}(\mathbf{y})\big) \big] = \partial_{y_j}\big(C_{ijrs}(\mathbf{y}) \big) &amp; \text{ in } \mathbf{Y} \\
							\big[C_{ijkl} (\mathbf{y}) \mathbf{e}_{kl, y}\big(\mathbf{N}^{rs})(\mathbf{y}) \big) \big] n_j = \mathbf{0} &amp; \text{ on } \partial\mathbf{Y}
						\end{aligned}
						\end{equation}
						with average equal $\mathbf{0}$ condition.</p>
					</section>
					<section>
						<h3>Elastic Model</h3>
						<ol>
							<li>The material coefficients are assumed over the characteristic cell in the form:
							\begin{equation}
								C_{ijkl}(\mathbf{y}) := C^m_{ijkl}\mathbb{I}_{\{ \mathbf{y} \in \mathbf{Y}_m \}} + C^f_{ijkl} \mathbb{I}_{\{\mathbf{y} \in \mathbf{Y}_p \}}
							\end{equation}</li>
							<li>Being each component with transverse isotropic elatic behavior, describing a full elastic tensor in \text{Voigt} notation:
							\begin{equation}
								C_{ij}(\mathbf{y}) = 
    							\begin{bmatrix}
    							C_{11}(\mathbf{y}) & C_{12}(\mathbf{y}) & C_{13}(\mathbf{y}) & 0 & 0 & 0 \\
    							C_{12}(\mathbf{y}) & C_{11}(\mathbf{y}) & C_{23}(\mathbf{y}) & 0 & 0 & 0 \\
    							C_{13}(\mathbf{y}) & C_{23}(\mathbf{y}) & C_{23}(\mathbf{y}) & 0 & 0 & 0 \\
    							0 & 0 & 0 & C_{44}(\mathbf{y}) & 0 & 0 \\
    							0 & 0 & 0 & 0 & C_{44}(\mathbf{y}) & 0 \\
    							0 & 0 & 0 & 0 & 0 & C_{66}(\mathbf{y}) 
							    \end{bmatrix}
							\end{equation}</li>
						</ol>
					</section>
					<section>
						<p> We take into account a 2D square model as microstructure characterizing the mesoscale </p>
						<img src="pictures/HomBasicOrders.png" width="1052" height="618">
						<p style="font-size: 20px" class="fragment">The choice of periodic geometry shows similar results to the curves obtained in Parnell et al. 2008 (reference)</p>
					</section>

					<section>
						<p>Solution are obtained using FEniCS library in Python at different mesh sizes. For example, in the case of a 2D square.</p>
						<img src="pictures/CellProb_MainHomCoeffsCircular.png" class="fragment" width="1497" height="384">
						<p style="font-size: 20px" class="fragment">Diagonal coefficients of the simulated homogenized elastic tensor.</p>
					</section>
					<section>
						<img src="pictures/CellProb_OthersHomCoeffsCircular.png" class="fragment" width="1504" height="384">
						<p style="font-size: 20px" class="fragment">The Non-diagonal coefficients of the homogenized elastic tensor.</p>
					</section>


					<!-- NOT CONSIDERED UNTIL FURTHER RESULTS


					<section>
						<h4 class="fragment">
							Could a change in the structure (from square to a hexagonal microstructure) produce better results?
						</h4>
						<p style="font-size: 20px" class="fragment">Such a microstructure is proposed and used by our reference of solution (P&G).</p>
					</section>
					<section>
						<p style="font-size:25px">Now, taking into account a Hexagonal model as microstructure for mesoscale </p>
						<img src="pictures/CellProb_MainHomCoeffsCircularHexa.png" class="fragment" width="1200" height="330">
						<p style="font-size: 20px" class="fragment">Diagonal coefficients of the simulated homogenized elastic tensor.</p>
					</section>
					<section>
						<img src="pictures/CellProb_OthersHomCoeffsCircularHexa.png" class="fragment" width="1200" height="350">
						<p style="font-size: 20px" class="fragment">The coefficient $C_{66}$ behaves bladly, as reported also compring with experimental results.</p>
						<p style="font-size: 20px" class="fragment"> Relative error $ \sim 10 \%$ </p>
					</section>


					-->
					<section>
						<h3 class="fragment">
							Our main problem is related in both cases to the behavior of the $C_{66}$ coeffs, and moreover with $C_{12}$. Both related to the anti-plane behavior.
						</h3>
						<p class="fragment">
							The main reason is related to the different boundary conditions possible to impose in the cell problem, since its necessary to impose a average to zero boundary condition.
						</p>
						<p class="fragment">
							Let us expand the 2-dimensional model to a 3-dimensional cubic microstructure.
						</p>
					</section>
					<section>
						<p>
							Using a cubic microstructure representing the mesoscale.
						</p>
						<img src="pictures/3DCellProb_MainHomCoeffsCircular.png" class="fragment" width="1497" height="384">
						<p class="fragment" style="font-size: 20px" align="center"> Main diagonal coefficients </p>
					</section>
					<section style="font-size: 20px">
						<img src="pictures/3DCellProb_OthersHomCoeffsCircular.png" class="fragment" width="1504" height="384">
						<p align="center" class="fragment"> Non-diagonal coeffs. numerically close to reference solutions. Except the $C_{66}$ coeff. The model doesn't incorporate possible non-axial elastic behavior. </p>
					</section>
					<section data-markdown>
						<h3>Percentage Error</h3>
						<textarea data-template>
								| **Error (RMSE)**| $\phi = 5\%$ | $\phi = 10 \%$ | $\phi = 20 \%$ |
								| -------------- |:----------:| -------------:| --------------:|
								| $C_{22}^{hom}$ | 2.1 % | 3.5 % | 4.3 % |
								| $C_{33}^{hom}$ | 0.5 % | 0.9 % | 0.2 % |
								| $C_{55}^{hom}$ | 0.6 % | 1.3 % | 0.9 % |
								| $C_{66}^{hom}$ | 1.8 % | 5.0 % | 9.9 % |
								| $C_{12}^{hom}$ | 1.4 % | 1.7 % | 2.1 % | 
								| $C_{23}^{hom}$ | 1.8 % | 2.7 % | 1.9 % |
						</textarea>
					</section>
				</section>

				<!-- SECTION: 2D IMPLEMENTATION AND NUMERICAL SIMULATIONS WITH FK-DIAGRMAS -->
				<section style="font-size: 25px; text-align: left">
					<section>
						<h3>2-Dimensional Simulations</h3>
						<p>
							The simulation setting, is defined by a rectangular domain imitating the experimental setup, i.e.,
						</p>
						<ol>
							<li>A set of 5-12 different sources, defining unique wave-guide propagation profiles. Each one activated independently, characterizing the porosity and thickness parameters.</li>
							<li>Detection is obtained by 24-72 different sensors depending on the configuration used.</li>
							<li>Propagation profiles are compared with PG results, which define the reference.</li>
						</ol>
					</section>
					<section>
						<h3>Tranducer force</h3>
						<p class="fragment"> Each force acting at the surface is modeled normal to horizontal plane of the domain surface, pointing to the mid section of the cortical bone, with central time $t_0 >0$, angular velocity $\tau_0 > 0$ at positions $\Gamma_{u_i} \subset \Gamma_N$ in the form:
						\begin{equation}
							\mathbf{F}(\mathbf{x},t) = - e^{\frac{(t-t_0)^2}{2\sigma^2}} cos(2 \pi t \tau_0) \mathbb{I}_{\mathbf{x}\in \Gamma_{u_i}} \hat{j} \text{ on } \Gamma_N
						\end{equation}</p>
						<img src="pictures/ForceSource.png" class="fragment" width="994" height="413">
						<p>Implementation done using $t_0 =1 [\mu s]$, $\sigma_0 = 0.7 [\mu s], \tau_0 = 1$. Left side: Time plot; Right side: FFT Force.</p>
					</section>
					<section>
						<h3>Schematic setting</h3>
						<img src="pictures/SimP5TransIso12M780-MeshFile.png" class="fragment" width="1080" height="375">
					</section>
					<section data-markdown>
						<textarea data-template>
							**Computational aspects**
							
							* The mesh generation is done using $\texttt{CGAL}$ library, for tethaedral meshes with $40$ and $20 [\mu m]$ of mean diameter.
							* There is observed a clear dependence of the mesh discretization with respect to the inverse problem prediction.
							* Elastodynamic models are simulated for set of pairs $(Po, Th)$, evaluating the inverse problem predictions from the data recovery process.


							| **Mesh Size**| $40 [\mu m]$ | $20 [\mu m]$ |
							| -------------- |:----------:| -------------:| 
							| N° Points  | $\sim 30.000$  | $\sim 90.000$ | 
							| N° Cells | $\sim 60.000$ | $\sim 300.000$ |
						</textarea>
					</section>
					<section>
						<p>A linear elastodynamic model is simulated using FEM discretization on space and $\beta,\gamma$-Newmark method on time, implemented with FEniCS</p>
						<video width="700" height="350" controls>
							<source src="animations/TwoCasesStreamLinesThick.webm" type="video/webm">
						</video>
					</section>
					<section>
						<h3>Multiple Sources</h3>
						<ol>
							<li>It is simulated under the setting of 8 sources activated independently, thus defining 8 different wave-guided propagation.</li>
							<li>The computational times in this case vary according to the thickness parameter.</li>
							<li>At a test size of $40 [\mu m]$ for cell diameter, the simulation takes $\sim 16-28$ hours on a high performance laptop, for which at cell diameters of $20 [\mu m]$ would take $\sim 5-7$ days.</li>
						</ol>
					</section>
					<section>
						<h3>Lamb waves for the Multisource simulations.</h3>
						<img src="animations/Th20Po13-FKMatrixAnimation.gif" alt="vertical" width="1000" height="400">
						<p style="font-size: 20px">Case of porosity at $20 \%$ and cortical thickness of $\sim 13 [mm]$</p>
					</section>
					<section>
						<h3>Single Source</h3>
						<ol>
							<li>The multisource input force generates problems of computations under limited resources and time.</li>
							<li>The recording obtained from each source excitation define spacially translated wavefronts.</li>
							<li>Since the homogenized tensor is constant in space, by the symmetry of the space the setting can be reduce to just one source now adding more receptors.</li>
							<li>The simulations times ranges regarding the thickness parameter used. On a <em>Xeon E5-2660 processor</em> with 4 Gb. DRR3 RAM for a $20 [\mu m]$ mesh, it takes $\sim 18-26$ hrs. to describe the full simulation using 1024 time steps assciated to $51.2 [\mu s]$ of real-time experimentation.</li>
						</ol>
					</section>
					<section>
						<p>Recorded dispersion curves</h2>
						<div class="container">
							<img src="animations/Th33Po6-FK-nH-M1460MatrixAnimation.gif" alt="WithoutHilbert" width="1131" height="393">
						</div>
						<p style="font-size: 20px">Case of Thickness $3.3 [mm]$ and $6\%$ of porosity.</p>
					</section>
					<section>
						<h3>Statistical Analysis</h3>
						<p>The validation of the parameter recuperation is done by using uniformly distributed pairs in the parameter space of biomedical interest, and compare the results regarding the Root Mean Square Error (RMSE)</p>
						<table>
 						<tr>
  							<th>$\textbf{RMSE}$</th>
  							<th>$\textbf{Porosity}\, (0-30) \%$</th>
  							<th>$\textbf{Thickness}\, (1-4) [mm]$</th>
 						</tr>
 						<tr>
  							<td>Axial Meas.</td>
  							<td>$0.87 \%$</td>
  							<td>$0.02 [mm]$</td>
 						</tr>
 						<tr>
  							<td>Anti-Axial Meas.</td>
  							<td>$0.47 \%$</td>
  							<td>$\ll 0.01 [mm]$</td>
 						</tr>
 						<tr>
 							<td>Composed</td>
 							<td>$1.2 \%$</td>
 							<td>$0.03 [mm]$</td>
 						</tr>
						</table>
					</section>
					<!--
					<section>
						<div class="container">
							<img src="animations/Th33Po6-FK-H-M1460MatrixAnimation.gif" alt="WithHilbert" width="1000" height="400">
						</div>
						<p style="font-size: 20px">Case of Thickness $3.3 [mm]$ and $6\%$ of porosity. Using Hilbert tranform</p>
					</section>
					-->
				</section>
					
				<!-- SECTION: 3D IMPLEMENTATION AND NUMERICAL SIMULATIONS WITH FK-DIAGRMAS -->
				<section style="font-size: 25px; text-align: left">
					<section>
						<h3>3-Dimensional Simulations</h3>
						<p>
							It is now studied the effect of radial wave behavior on the recorded signal, assessing the wave-guide propagation by cylindrical and fully irregular type domains.
						</p>
						<ol>
							<li>A Half-Cylinder domain that assess curvature effects on the recorded signal and the distortion generated from the wave interaction. It describes the first approximation of realistic bone samples from $\mu$-CT images.</li>
							<li>A rugous model retrieved from the $\mu$-CT images to assess the wave propagation now by the interior irregularities and non-uniformities naturally presented on bone samples.</li>
						</ol>
					</section>
					<section>
						<h3>Half-Cylinder Case</h3>
						<p class="fragment">The implementation setting ressembles the 2-dimensional case, by using the same type of force at the emitters</p>
						<ol>
							<li>A set of 40 sensors are modelled to capture surface forces $\sigma^{hom}(u)\cdot n$ at each location generated by the propagating wave-front.</li>
							<li>The elastodynamic simulation of the homogenized transverse isotropic model is done using a single emitter.</li>
							<li>The simulations times ranges regarding the thickness parameter used. On a <em>Xeon E5-2660 processor</em> with 5 Gb. DRR3 RAM for a mesh of $40 [\mu m]$ of cell diameters, takes $\sim 25-35$ hrs. to describe a full device recordings discretize by 1024 time steps associated to $51.2 [\mu s]$ of real-time experimentation.</li>
						</ol>
					</section>
					<section>
						<h3>Schematic setting</h3>
						<img src="pictures/HalfCyl3d-MeshBoundaries.png" class="center" width="873" height="479">
						<p style="font-size: 20px">Tetraedrical mesh defined using $\texttt{CGAL}$ with mean cell diameter of $40 [\mu m]$. Number of vertices: $\sim 170.000$; Number of cells: $\sim 956.000$. Colors indicating tagged subdomains.</p>
					</section>
					<section>
						<p>A linear elastodynamic model is simulated using FEM discretization on space and $\beta,\gamma$-Newmark method on time, implemented with FEniCS</p>
						<img src="animations/TimeCyl.gif" width="1496" height="437">
					</section>
					<section>
						<p>Recorded dispersion curves</h2>
						<div class="container">
							<img src="animations/TimeCyl-FK.gif" alt="WithoutHilbert" width="1199" height="323">
						</div>
						<p style="font-size: 20px">Recorded dispersion curves in the form of $(f,k)$-diagram of the $L_M(f,k)$ functional. Case of $11 \%$ porosity with $1.8 [mm]$ thickness.</p>
						<p style="font-size: 20px">The parameter recuperation retrieves $\sim 1.01 \%$ of porosity and $1.801\%$ thickness.</p>
					</section>
					<section>
						<h3>Irregular Domain Case</h3>
						<p>The half-cylinder domain simulations shows clear correspondence with the 2-dimensional case, showing the prevalence of axial-propagation over the non-axial effects that occurs during the wave-front.</p>
						<p>It does not incorporates irregularity effects arising from the curvature nor infero-interior surfaces presented on real bone samples.</p>
					</section>
					<section>
						<h3>Mesh Generation</h3>
						<p>The mesh genration is done by the following data-flow procedure, by applying several layers of software. It creates a realistic complex tetrahedral mesh from a processsed volumetic image using $\texttt{CGAL}$ library.</p>
						<ol>
							<li>A scaling procedure from $9 \, [\mu m]$ voxel images is done to restrict memory consumption of the $\mu$-CT images stack.</li>
							<li>The stack is processed based of grayscale values regarding the materials of interest.</li>
							<li>A volumetic image is created, and parametrized to be processed with $\texttt{iso2mesh}$ library with mesh efficient mesh generation algorithms.</li>
						</ol>
					</section>
					<section>
						<img src="pictures/DiagramMeshGeneration.png" width="1065" height="575">
						<p style="font-size: 20px">Data-Flow: The mesh generation involves a sequence of frameworks to optain a fully automatized procedure.</p>
					</section>
					<section>
						<h3>Mesh from $\mu$-CT images</h3>
						<img src="pictures/CorticalBoneS1000OPT20-View.png">
						<p style="font-size: 20px">The adaptive mesh resembles a real geoetry by meshing the inner surface irregularities characteristic of the natural cortical bone. Generated from $1000$ slices of $\mu$-CT images, corresponding to thickness $\sim 1.8 [mm]$ and experimentally measured porosity $\sim 11 \%$. It is described by $\sim 430.000$ points and $\sim 1.400.0000$ cells.</p>
					</section>
					<section style="font-size: 20px">
						<h3>Implementation Setting</h3>
						<ol>
							<li>1-source type simulation is done, over a set of 48 tagged receptors.</li>
							<li>Each receptor is defined for width $\sim 0.8 [mm]$ and height $\sim 8 [mm]$ located at the boundary, recoding the resulting force $\sigma^{hom}(u)\cdot n$.</li>
							<li>The Elastodynamic PDE is re-scaled to the $56 [\mu m]$ voxel length and discretized by FEM in space and $\beta-\gamma$-Newmark scheme in time.</li>
						</ol>
						<img src="pictures/Cortical3dsc04Mesh1000Fill-MeshBoundaries.png" class="center" width="811" height="425" >
					</section>
					<section>
						<img src="animations/TimeHom.gif" width="1496" height="437">
						<p style="font-size: 20px">The elastodynamic model over the complex domain at $\sim 8 [\mu m]$ of cell tetrahedras, requires 2 cores on a Xeon E5-2660 processor with $\sim 8 Gb$ DDR3 RAM and $\sim 7$ days of computation time.</p>
					</section>
					<section>
						<h3>Dispersion curves</h3>
						<p>The effects of the wave-front with the domain irregularities are shown in the $(f,k)$ diagram. It describes discrepancy of the reconstructed dispersion curves regarding the reference. In particular on the first symmetric and antisymmetric mode.</p>
						<img src="animations/TimeHom-FK.gif" width="1199" height="323">
					</section>
				</section>

				<!-- SECTION: HOMOGENIZED VISCOELASTIC FORMULATION -->
				<section style="font-size: 25px; text-align: left">
					<section>
						<h3>Viscous Predictions</h3>
						<ol>
							<li>Factors o risk fracture such as thickness, porosity and others defied the bone quality assessed by DXA techniques, and BMD values.</li>
							<li>The QUS method from <em>Minonzio, Foiret et al. 2016, 2018</em> is based on recording from the guided-wave propagation over the media, where damping behavior naturally is presented on the signal.</li>
							<li>Resonant Ultrasoung Spectroscopy (RUS) techniques assess such behavior on cortical bone, produced from the collagen fibers.</li>
							<li>Description of daming effects is not new, <em>Bernard et al 2015</em> studied such behavior from experimental measurements on frequency domain, with elastic behavior:
							\begin{equation}
								C_{ij}^* = C_{ij} + i C_{ij}' = C_{ij}(1+ Q_{ij}^{-1}), \quad i,j = 1,\dots, 6
							\end{equation}</li>
						</ol>
					</section>
					<section>
						<h3>Objectives</h3>
						<ol>
							<li>Define an adequate multiscale viscoelastic model, to assess damping effects.</li>
							<li>Reformulate the $Q_{ij}$-factors following the two-scale homogenization formalism.</li>
							<li>Retrieve numerically elastic coefficients,quality factors with comparable results and predictions.</li>
						</ol>
					</section>
					<section>
						<h3>Mechanical Description</h3>
						<p>The viscoelastic mechanical model is assumed of <em>Kelvin-Voigt</em> type, with microstructure $\mathbf{Y} = Y_m \cup Y_f$.</p>
						<ol>
							<li>The elastic behavior is assumed in the form for both bone matrix and porous:
							\begin{equation}
								C_{ijkl}(\mathbf{y}) = C^m_{ijkl} \mathbb{I}_{Y_m}(\mathbf{y}) + C^f_{ijkl}\mathbb{I}_{Y_f}(\mathbf{y})
							\end{equation}</li>
							<li>Moreover, the porosity is assumed with viscous behavior:
							\begin{equation}
								D_{ijkl}(\mathbf{y}) = D^m_{ijkl} \mathbb{I}_{Y_m}(\mathbf{y}) + D^f_{ijkl}\mathbb{I}_{Y_f}(\mathbf{y})
							\end{equation}</li>
							<li>The viscosity is assumed linearly dependent on the elasticity:
							\begin{equation}
							D^m_{ijkl}(\mathbf{y}) = \epsilon^{(m)} C^m_{ijkl}(\mathbf{y}), \quad D^f_{ijkl}(\mathbf{y}) = \epsilon^{(f)}C^{f}_{ijkl}(\mathbf{y})
							\end{equation}</li>
						</ol>
					</section>
					<section>
						<h3>
							The displacement then satisfies the following system:
						</h3>
						<p class="fragment">
							\[
							\begin{aligned}
							\rho^{\epsilon} \partial_{tt} u^{\epsilon}  - \nabla \cdot \sigma(u^{\epsilon}, \partial_t u^{\epsilon}) = \mathbf{0}  &amp; \text{ in } (0,T) \times \Omega \\
							\sigma (u^{\epsilon}, \partial_t u^{\epsilon}) \cdot n = C(\frac{\mathbf{x}}{\epsilon}) : \mathbf{e}(u^{\epsilon}) + D(\frac{\mathbf{x}}{\epsilon}):\mathbf{e}(\partial_t u^{\epsilon}) &amp; \text{ in } (0,T)\times \Omega \\
							\sigma(u^{\epsilon}, \partial_t u^{\epsilon}) \cdot n = \mathbf{F} &amp;\text{ in } (0,T) \times \Gamma_N \\
							u^{\epsilon} = \mathbf{0} &amp; \text{ in } (0,T)\times \Gamma_D \\
							\end{aligned}
							\]
						</p>
					</section>
					<section>
						<h3 class="fragment">
							Since <em>Bernard et al. 2015</em> studied the measurements in frequency domain, it is considered the <em>Kelvin-Voigt</em> model on the fourier domain.
						</h3>
						<p class="fragment">Explicitely, for fixed frequency $\omega \in \mathbb{R}$ it is considered the following PDE system:</p>
						<p class="fragment">
							\[
							\begin{aligned}
							-\langle \rho\rangle_{\mathbf{Y}} \omega^2 \hat{v}  - \nabla \cdot \hat{\sigma}(\hat{v}) &amp;= \mathbf{0}  &amp; \text{ in } \Omega \\
							\hat{\sigma}_{ij}(\hat{v})n_j &amp;= (C_{ijkl}(\frac{\mathbf{x}}{\epsilon}) + \mathbf{i}\omega D_{ijkl}(\frac{\mathbf{x}}{\epsilon}))\mathbf{e}_{kl}(\hat{v}) &amp; \text{ in } \Omega \\
							\hat{\sigma}(\hat{v}) \cdot n &amp;= \hat{\mathbf{F}} &amp;\text{ in } \Gamma_N \\
							\hat{v} &amp;= \mathbf{0} &amp; \text{ in } \Gamma_D \\
							\end{aligned}
							\]
						</p>
					</section>
					<section>
						<p class="fragment">
							Now, by a similar procedure it is possible to obtain at fixed frequency $\omega$, the governing viscoelastic (homogenized) behavior given by:
						</p>
						<p class="fragment">
							\[
							\begin{aligned}
							-\langle \rho\rangle_{\mathbf{Y}} \, \omega^2 \hat{v}  - \nabla \cdot \hat{\sigma}(\hat{v}) = \mathbf{0}  &amp; \text{ in } \Omega \\
							\hat{\sigma}_{ij}(\hat{v})n_j = (C^{hom}_{ijkl} + \mathbf{i}\omega D_{ijkl}^{hom})\mathbf{e}_{kl}(\hat{v}) &amp; \text{ in } \Omega \\
							\hat{\sigma}(\hat{v}) \cdot n = \hat{\mathbf{F}} &amp;\text{ in } \Gamma_N \\
							\hat{v} = \mathbf{0} &amp; \text{ in } \Gamma_D \\
							\end{aligned}
							\]
						</p>
					</section>
					<section>
						<p class="fragment">
							In particular, the cell problems are then expressed as complex vector valued functions $N^{rs}(\mathbf{y})$ $\mathbf{Y}$-periodic solutions to the equation
						</p>
						<p class="fragment">
							\[
							\begin{equation*}
							-\partial_{y_j}\big[ \big(C_{ijkl}+ \mathbf{i}\omega D_{ijkl}\big) \mathbf{e}_{kl,y}\big( N^{rs}\big) \big] = \partial_{y_j} \big[ C_{ijrs} + \mathbf{i}\omega D_{ijrs}\big]
							\end{equation*}
							\]
						</p>
						<p class="fragment">Supplemented with condition $\langle N^{rs} \rangle_{\mathbf{Y}} = \mathbf{0}$, i.e. of average zero at $\mathbf{Y}$.</p>
					</section>
					<section>
						<p class="fragment">
							Decomposing the solution as it's real and imaginary part, $N^{rs} = N_R^{rs} + i N_I^{rs}$ it follows then:
						</p>
						<p class="fragment">
							\[
							\begin{aligned}
							C^{hom}_{ijrs} &amp;= \langle C_{ijrs} + C_{ijkl} \mathbf{e}_{kl}(N^{rs}_R) -\omega D_{ijkl} \mathbf{e}_{kl}(N^{rs}_I) \rangle \\
							D^{hom}_{ijrs} &amp;= \langle \omega D_{ijrs} + C_{ijkl} \mathbf{e}_{kl}(N^{rs}_I) +\omega D_{ijkl} \mathbf{e}_{kl}(N^{rs}_R) \rangle
							\end{aligned}
							\]
						</p>
						<p class="fragment">
							Then following the literature of Bernard et. al. 2015, it is defined the $Q$-factor in Voigt notation as $Q_{ij}^{-1} = \frac{D^{hom}_{ij}}{C^{hom}_{ij}}$.
						</p>
					</section>
					<section>
						<p>
							The experimental data obtained from Bernard, shows the following behavior:
						</p>
						<div class="container">
							<img src="pictures/Q44_bernard2015.png" alt="vertical" width="430" height="400">
						</div>
						<div class="container">
							<img src="pictures/MultipleQ_bernard2015.png" alt="horizontal" width="430" height="400">
						</div>
					</section>
					<section>
						<p class="fragment">
							It is simulated with a viscous component of type $D_{ijkl}(\mathbf{y}) = \epsilon^w C^w_{ijkl}(\mathbf{y}) + \epsilon^b C^b_{ijkl}(\mathbf{y})$
							being $\epsilon^b = 5 \times 10^{-2}$ and $\epsilon^w = 1 \times 10^{-3}$.
						</p>
						<img src="pictures/QfactorsFreqsEPS5-2.png" class="fragment" width="1525" height="386">
						<p class="fragment">Simulations at different frequencies shows a result invariant to the freq. $f \in [0, 0.5] \,[Mhz]$.</p>
					</section>
					<section>
						<p>The numerical solution ressemble the real data? </p>
						<img src="pictures/CellProb_QfactorCircular5E-2_Relations.png" class="fragment" width="1525" height="386">
						<p class="fragment"> Well, the sort of!.</p>
					</section>
					<!--
					<section>
						<p>
							What is the nonlinear effect produced by the homogenization on the $Q_{ijkl}$ factors?
						</p>
						<img src="" class="fragment" width="" height="">
						<p class="fragment"> We observe a great nonlinear dependence on the coeffs. </p>
					</section>
					-->
				</section>

				<!-- SECTION: Final slides for questions -->
				<section style="text-align: left">
					<div class="moving-letters">
						<h3 class="ml11">
							<span class="text-wrapper">
								<span class="letters"> Importance of this model</span>
								<span class="letters"> Questions? </span>
							</span>
						</h3>
					</div>
				</section>

			</div>

		</div>
		<!-- Script  Library being used -->
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>
		<!-- External library for letters animation-->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  		<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
		<script src="js/letters.js"></script>

		<!-- REVEALJS EXTERNAL LIBRARIES -->
		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				autoPlayMedia: true,
				math: {
					// mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
					config: 'TeX-AMS_HTML-full'
				},

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/search/search.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'lib/js/classList.js' },
					{ src: 'plugin/math/math.js', async: true },
					{ src: 'plugin/letters-js.js', async: true}
				]
			});

		</script>

	</body>
</html>
